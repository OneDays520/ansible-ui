{"remainingRequest":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/src/views/project/Team.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/src/views/project/Team.vue","mtime":1639028924775},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJdGVtTGlzdFBhZ2VCYXNlIGZyb20gJ0AvY29tcG9uZW50cy9JdGVtTGlzdFBhZ2VCYXNlJzsKaW1wb3J0IFRlYW1NZW1iZXJGb3JtIGZyb20gJ0AvY29tcG9uZW50cy9UZWFtTWVtYmVyRm9ybS52dWUnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgVGVhbU1lbWJlckZvcm0gfSwKICBtaXhpbnM6IFtJdGVtTGlzdFBhZ2VCYXNlXSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBncmFudEFkbWluKHVzZXJJZCkgewogICAgICBhd2FpdCBheGlvcyh7CiAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgdXJsOiBgL2FwaS9wcm9qZWN0LyR7dGhpcy5wcm9qZWN0SWR9L3VzZXJzLyR7dXNlcklkfS9hZG1pbmAsCiAgICAgICAgcmVzcG9uc2VUeXBlOiAnanNvbicsCiAgICAgIH0pOwogICAgICBhd2FpdCB0aGlzLmxvYWRJdGVtcygpOwogICAgfSwKICAgIGFzeW5jIHJlZnVzZUFkbWluKHVzZXJJZCkgewogICAgICBhd2FpdCBheGlvcyh7CiAgICAgICAgbWV0aG9kOiAnZGVsZXRlJywKICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vdXNlcnMvJHt1c2VySWR9L2FkbWluYCwKICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJywKICAgICAgfSk7CiAgICAgIGF3YWl0IHRoaXMubG9hZEl0ZW1zKCk7CiAgICB9LAogICAgZ2V0SGVhZGVycygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICB0ZXh0OiAn5aeT5ZCNJywKICAgICAgICAgIHZhbHVlOiAnbmFtZScsCiAgICAgICAgICB3aWR0aDogJzUwJScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0ZXh0OiAn6LSm5oi3JywKICAgICAgICAgIHZhbHVlOiAndXNlcm5hbWUnLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGV4dDogJ+mCrueusScsCiAgICAgICAgICB2YWx1ZTogJ2VtYWlsJywKICAgICAgICAgIHdpZHRoOiAnNTAlJywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRleHQ6ICfnrqHnkIblkZgnLAogICAgICAgICAgdmFsdWU6ICdhZG1pbicsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0ZXh0OiAn5Yqo5L2cJywKICAgICAgICAgIHZhbHVlOiAnYWN0aW9ucycsCiAgICAgICAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAgICAgfV07CiAgICB9LAogICAgZ2V0U2luZ2xlSXRlbVVybCgpIHsKICAgICAgcmV0dXJuIGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vdXNlcnMvJHt0aGlzLml0ZW1JZH1gOwogICAgfSwKICAgIGdldEl0ZW1zVXJsKCkgewogICAgICByZXR1cm4gYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS91c2Vycz9zb3J0PW5hbWUmb3JkZXI9YXNjYDsKICAgIH0sCiAgICBnZXRFdmVudE5hbWUoKSB7CiAgICAgIHJldHVybiAnaS1yZXBvc2l0b3JpZXMnOwogICAgfSwKICAgIGlzVXNlckFkbWluKCkgewogICAgICByZXR1cm4gKHRoaXMuaXRlbXMuZmluZCgoeCkgPT4geC5pZCA9PT0gdGhpcy51c2VySWQpIHx8IHt9KS5hZG1pbjsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Team.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Team.vue","sourceRoot":"src/views/project","sourcesContent":["<template xmlns:v-slot=\"http://www.w3.org/1999/XSL/Transform\">\n  <div v-if=\"items != null\">\n    <EditDialog\n      v-model=\"editDialog\"\n      :save-button-text=\"(this.itemId === 'new' ? '关联' : '保存')\"\n      :title=\"(this.itemId === 'new' ? '新' : '编辑') + ' 团队成员'\"\n      @save=\"loadItems()\"\n    >\n      <template v-slot:form=\"{ onSave, onError, needSave, needReset }\">\n        <TeamMemberForm\n          :project-id=\"projectId\"\n          :item-id=\"itemId\"\n          @save=\"onSave\"\n          @error=\"onError\"\n          :need-save=\"needSave\"\n          :need-reset=\"needReset\"\n        />\n      </template>\n    </EditDialog>\n\n    <YesNoDialog\n      title=\"Delete team member\"\n      text=\"Are you really want to delete the team member?\"\n      v-model=\"deleteItemDialog\"\n      @yes=\"deleteItem(itemId)\"\n    />\n\n    <v-toolbar flat color=\"white\">\n      <v-app-bar-nav-icon @click=\"showDrawer()\"></v-app-bar-nav-icon>\n      <v-toolbar-title>团队成员</v-toolbar-title>\n      <v-spacer></v-spacer>\n      <v-btn\n        color=\"primary\"\n        @click=\"editItem('new')\"\n      >新成员</v-btn>\n    </v-toolbar>\n\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"items\"\n      hide-default-footer\n      class=\"mt-4\"\n      :items-per-page=\"Number.MAX_VALUE\"\n    >\n      <template v-slot:item.admin=\"{ item }\">\n\n        <v-switch\n          v-model=\"item.admin\"\n          inset\n          :disabled=\"!isUserAdmin()\"\n          @change=\"item.admin ? grantAdmin(item.id) : refuseAdmin(item.id)\"\n        ></v-switch>\n      </template>\n\n      <template v-slot:item.actions=\"{ item }\">\n        <v-btn\n          icon\n          :disabled=\"!isUserAdmin()\"\n          @click=\"askDeleteItem(item.id)\"\n        >\n          <v-icon>mdi-delete</v-icon>\n        </v-btn>\n      </template>\n    </v-data-table>\n  </div>\n\n</template>\n<script>\nimport ItemListPageBase from '@/components/ItemListPageBase';\nimport TeamMemberForm from '@/components/TeamMemberForm.vue';\nimport axios from 'axios';\n\nexport default {\n  components: { TeamMemberForm },\n  mixins: [ItemListPageBase],\n  methods: {\n    async grantAdmin(userId) {\n      await axios({\n        method: 'post',\n        url: `/api/project/${this.projectId}/users/${userId}/admin`,\n        responseType: 'json',\n      });\n      await this.loadItems();\n    },\n    async refuseAdmin(userId) {\n      await axios({\n        method: 'delete',\n        url: `/api/project/${this.projectId}/users/${userId}/admin`,\n        responseType: 'json',\n      });\n      await this.loadItems();\n    },\n    getHeaders() {\n      return [\n        {\n          text: '姓名',\n          value: 'name',\n          width: '50%',\n        },\n        {\n          text: '账户',\n          value: 'username',\n        },\n        {\n          text: '邮箱',\n          value: 'email',\n          width: '50%',\n        },\n        {\n          text: '管理员',\n          value: 'admin',\n        },\n        {\n          text: '动作',\n          value: 'actions',\n          sortable: false,\n        }];\n    },\n    getSingleItemUrl() {\n      return `/api/project/${this.projectId}/users/${this.itemId}`;\n    },\n    getItemsUrl() {\n      return `/api/project/${this.projectId}/users?sort=name&order=asc`;\n    },\n    getEventName() {\n      return 'i-repositories';\n    },\n    isUserAdmin() {\n      return (this.items.find((x) => x.id === this.userId) || {}).admin;\n    },\n  },\n};\n</script>\n"]}]}