{"remainingRequest":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/src/components/TemplateForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/src/components/TemplateForm.vue","mtime":1638860266321},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qIGVzbGludC1kaXNhYmxlIGltcG9ydC9uby1leHRyYW5lb3VzLWRlcGVuZGVuY2llcyxpbXBvcnQvZXh0ZW5zaW9ucyAqLwoKaW1wb3J0IEl0ZW1Gb3JtQmFzZSBmcm9tICdAL2NvbXBvbmVudHMvSXRlbUZvcm1CYXNlJzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKCmltcG9ydCB7IGNvZGVtaXJyb3IgfSBmcm9tICd2dWUtY29kZW1pcnJvcic7CmltcG9ydCAnY29kZW1pcnJvci9saWIvY29kZW1pcnJvci5jc3MnOwppbXBvcnQgJ2NvZGVtaXJyb3IvbW9kZS92dWUvdnVlLmpzJzsKLy8gaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2xpbnQvanNvbi1saW50LmpzJzsKaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2Rpc3BsYXkvcGxhY2Vob2xkZXIuanMnOwppbXBvcnQgeyBURU1QTEFURV9UWVBFX0lDT05TLCBURU1QTEFURV9UWVBFX1RJVExFUyB9IGZyb20gJy4uL2xpYi9jb25zdGFudHMnOwoKZXhwb3J0IGRlZmF1bHQgewogIG1peGluczogW0l0ZW1Gb3JtQmFzZV0sCgogIGNvbXBvbmVudHM6IHsKICAgIGNvZGVtaXJyb3IsCiAgfSwKCiAgcHJvcHM6IHsKICAgIHNvdXJjZUl0ZW1JZDogU3RyaW5nLAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpdGVtVHlwZUluZGV4OiAwLAogICAgICBURU1QTEFURV9UWVBFX0lDT05TLAogICAgICBURU1QTEFURV9UWVBFX1RJVExFUywKICAgICAgY21PcHRpb25zOiB7CiAgICAgICAgdGFiU2l6ZTogMiwKICAgICAgICBtb2RlOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgbGluZU51bWJlcnM6IHRydWUsCiAgICAgICAgbGluZTogdHJ1ZSwKICAgICAgICBsaW50OiB0cnVlLAogICAgICAgIGluZGVudFdpdGhUYWJzOiBmYWxzZSwKICAgICAgfSwKICAgICAgaXRlbTogbnVsbCwKICAgICAga2V5czogbnVsbCwKICAgICAgaW52ZW50b3J5OiBudWxsLAogICAgICByZXBvc2l0b3JpZXM6IG51bGwsCiAgICAgIGVudmlyb25tZW50OiBudWxsLAogICAgICBzY2hlZHVsZXM6IG51bGwsCiAgICAgIHZpZXdzOiBudWxsLAogICAgICBjcm9uRm9ybWF0OiBudWxsLAogICAgICBoZWxwRGlhbG9nOiBudWxsLAogICAgICBoZWxwS2V5OiBudWxsLAogICAgfTsKICB9LAoKICB3YXRjaDogewogICAgbmVlZFJlc2V0KHZhbCkgewogICAgICBpZiAodmFsKSB7CiAgICAgICAgaWYgKHRoaXMuaXRlbSAhPSBudWxsKSB7CiAgICAgICAgICB0aGlzLml0ZW0udGVtcGxhdGVfaWQgPSB0aGlzLnRlbXBsYXRlSWQ7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIHNvdXJjZUl0ZW1JZCh2YWwpIHsKICAgICAgdGhpcy5pdGVtLnRlbXBsYXRlX2lkID0gdmFsOwogICAgfSwKCiAgICBpdGVtVHlwZUluZGV4KHZhbCkgewogICAgICB0aGlzLml0ZW0udHlwZSA9IE9iamVjdC5rZXlzKFRFTVBMQVRFX1RZUEVfSUNPTlMpW3ZhbF07CiAgICB9LAogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBpc0xvYWRlZCgpIHsKICAgICAgaWYgKHRoaXMuaXNOZXcgJiYgdGhpcy5zb3VyY2VJdGVtSWQgPT0gbnVsbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5rZXlzICE9IG51bGwKICAgICAgICAgICYmIHRoaXMucmVwb3NpdG9yaWVzICE9IG51bGwKICAgICAgICAgICYmIHRoaXMuaW52ZW50b3J5ICE9IG51bGwKICAgICAgICAgICYmIHRoaXMuZW52aXJvbm1lbnQgIT0gbnVsbAogICAgICAgICAgJiYgdGhpcy5pdGVtICE9IG51bGwKICAgICAgICAgICYmIHRoaXMuc2NoZWR1bGVzICE9IG51bGwKICAgICAgICAgICYmIHRoaXMudmlld3MgIT0gbnVsbDsKICAgIH0sCgogICAgbG9naW5QYXNzd29yZEtleXMoKSB7CiAgICAgIGlmICh0aGlzLmtleXMgPT0gbnVsbCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmtleXMuZmlsdGVyKChrZXkpID0+IGtleS50eXBlID09PSAnbG9naW5fcGFzc3dvcmQnKTsKICAgIH0sCiAgfSwKCiAgbWV0aG9kczogewogICAgc2hvd0hlbHBEaWFsb2coa2V5KSB7CiAgICAgIHRoaXMuaGVscEtleSA9IGtleTsKICAgICAgdGhpcy5oZWxwRGlhbG9nID0gdHJ1ZTsKICAgIH0sCgogICAgYXN5bmMgYWZ0ZXJMb2FkRGF0YSgpIHsKICAgICAgaWYgKHRoaXMuc291cmNlSXRlbUlkKSB7CiAgICAgICAgdGhpcy5pdGVtID0gKGF3YWl0IGF4aW9zKHsKICAgICAgICAgIGtleXM6ICdnZXQnLAogICAgICAgICAgdXJsOiBgL2FwaS9wcm9qZWN0LyR7dGhpcy5wcm9qZWN0SWR9L3RlbXBsYXRlcy8ke3RoaXMuc291cmNlSXRlbUlkfWAsCiAgICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJywKICAgICAgICB9KSkuZGF0YTsKICAgICAgfQoKICAgICAgdGhpcy5rZXlzID0gKGF3YWl0IGF4aW9zKHsKICAgICAgICBrZXlzOiAnZ2V0JywKICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0va2V5c2AsCiAgICAgICAgcmVzcG9uc2VUeXBlOiAnanNvbicsCiAgICAgIH0pKS5kYXRhOwoKICAgICAgdGhpcy5yZXBvc2l0b3JpZXMgPSAoYXdhaXQgYXhpb3MoewogICAgICAgIGtleXM6ICdnZXQnLAogICAgICAgIHVybDogYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS9yZXBvc2l0b3JpZXNgLAogICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLAogICAgICB9KSkuZGF0YTsKCiAgICAgIHRoaXMuaW52ZW50b3J5ID0gKGF3YWl0IGF4aW9zKHsKICAgICAgICBrZXlzOiAnZ2V0JywKICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vaW52ZW50b3J5YCwKICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJywKICAgICAgfSkpLmRhdGE7CgogICAgICB0aGlzLmVudmlyb25tZW50ID0gKGF3YWl0IGF4aW9zKHsKICAgICAgICBrZXlzOiAnZ2V0JywKICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vZW52aXJvbm1lbnRgLAogICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLAogICAgICB9KSkuZGF0YTsKCiAgICAgIHRoaXMuYnVpbGRUZW1wbGF0ZXMgPSAoYXdhaXQgYXhpb3MoewogICAgICAgIGtleXM6ICdnZXQnLAogICAgICAgIHVybDogYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS90ZW1wbGF0ZXM/dHlwZT1idWlsZGAsCiAgICAgICAgcmVzcG9uc2VUeXBlOiAnanNvbicsCiAgICAgIH0pKS5kYXRhLmZpbHRlcigodGVtcGxhdGUpID0+IHRlbXBsYXRlLnR5cGUgPT09ICdidWlsZCcpOwoKICAgICAgdGhpcy5zY2hlZHVsZXMgPSB0aGlzLmlzTmV3ID8gW10gOiAoYXdhaXQgYXhpb3MoewogICAgICAgIGtleXM6ICdnZXQnLAogICAgICAgIHVybDogYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS90ZW1wbGF0ZXMvJHt0aGlzLml0ZW1JZH0vc2NoZWR1bGVzYCwKICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJywKICAgICAgfSkpLmRhdGE7CgogICAgICB0aGlzLnZpZXdzID0gKGF3YWl0IGF4aW9zKHsKICAgICAgICBrZXlzOiAnZ2V0JywKICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vdmlld3NgLAogICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLAogICAgICB9KSkuZGF0YTsKCiAgICAgIGlmICh0aGlzLnNjaGVkdWxlcy5sZW5ndGggPT09IDEpIHsKICAgICAgICB0aGlzLmNyb25Gb3JtYXQgPSB0aGlzLnNjaGVkdWxlc1swXS5jcm9uX2Zvcm1hdDsKICAgICAgfQoKICAgICAgdGhpcy5pdGVtVHlwZUluZGV4ID0gT2JqZWN0LmtleXMoVEVNUExBVEVfVFlQRV9JQ09OUykuaW5kZXhPZih0aGlzLml0ZW0udHlwZSk7CiAgICB9LAoKICAgIGdldEl0ZW1zVXJsKCkgewogICAgICByZXR1cm4gYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS90ZW1wbGF0ZXNgOwogICAgfSwKCiAgICBnZXRTaW5nbGVJdGVtVXJsKCkgewogICAgICByZXR1cm4gYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS90ZW1wbGF0ZXMvJHt0aGlzLml0ZW1JZH1gOwogICAgfSwKCiAgICBhc3luYyBiZWZvcmVTYXZlKCkgewogICAgICBpZiAodGhpcy5jcm9uRm9ybWF0ID09IG51bGwgfHwgdGhpcy5jcm9uRm9ybWF0ID09PSAnJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYXdhaXQgYXhpb3MoewogICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgIHVybDogYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS9zY2hlZHVsZXMvdmFsaWRhdGVgLAogICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIGNyb25fZm9ybWF0OiB0aGlzLmNyb25Gb3JtYXQsCiAgICAgICAgfSwKICAgICAgfSk7CiAgICB9LAoKICAgIGFzeW5jIGFmdGVyU2F2ZShuZXdJdGVtKSB7CiAgICAgIGlmIChuZXdJdGVtIHx8IHRoaXMuc2NoZWR1bGVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGlmICh0aGlzLmNyb25Gb3JtYXQgIT0gbnVsbCAmJiB0aGlzLmNyb25Gb3JtYXQgIT09ICcnKSB7CiAgICAgICAgICAvLyBuZXcgc2NoZWR1bGUKICAgICAgICAgIGF3YWl0IGF4aW9zKHsKICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICAgIHVybDogYC9hcGkvcHJvamVjdC8ke3RoaXMucHJvamVjdElkfS9zY2hlZHVsZXNgLAogICAgICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJywKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgIHByb2plY3RfaWQ6IHRoaXMucHJvamVjdElkLAogICAgICAgICAgICAgIHRlbXBsYXRlX2lkOiBuZXdJdGVtID8gbmV3SXRlbS5pZCA6IHRoaXMuaXRlbUlkLAogICAgICAgICAgICAgIGNyb25fZm9ybWF0OiB0aGlzLmNyb25Gb3JtYXQsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zY2hlZHVsZXMubGVuZ3RoID4gMSkgewogICAgICAgIC8vIGRvIG5vdGhpbmcKICAgICAgfSBlbHNlIGlmICh0aGlzLmNyb25Gb3JtYXQgPT0gbnVsbCB8fCB0aGlzLmNyb25Gb3JtYXQgPT09ICcnKSB7CiAgICAgICAgLy8gZHJvcCBzY2hlZHVsZQogICAgICAgIGF3YWl0IGF4aW9zKHsKICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsCiAgICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vc2NoZWR1bGVzLyR7dGhpcy5zY2hlZHVsZXNbMF0uaWR9YCwKICAgICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIHVwZGF0ZSBzY2hlZHVsZQogICAgICAgIGF3YWl0IGF4aW9zKHsKICAgICAgICAgIG1ldGhvZDogJ3B1dCcsCiAgICAgICAgICB1cmw6IGAvYXBpL3Byb2plY3QvJHt0aGlzLnByb2plY3RJZH0vc2NoZWR1bGVzLyR7dGhpcy5zY2hlZHVsZXNbMF0uaWR9YCwKICAgICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLAogICAgICAgICAgZGF0YTogewogICAgICAgICAgICBpZDogdGhpcy5zY2hlZHVsZXNbMF0uaWQsCiAgICAgICAgICAgIHByb2plY3RfaWQ6IHRoaXMucHJvamVjdElkLAogICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGhpcy5pdGVtSWQsCiAgICAgICAgICAgIGNyb25fZm9ybWF0OiB0aGlzLmNyb25Gb3JtYXQsCiAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["TemplateForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6NA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TemplateForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-form\n      ref=\"form\"\n      lazy-validation\n      v-model=\"formValid\"\n      v-if=\"isLoaded\"\n  >\n    <v-dialog\n        v-model=\"helpDialog\"\n        hide-overlay\n        width=\"300\"\n    >\n      <v-alert\n          border=\"top\"\n          colored-border\n          type=\"info\"\n          elevation=\"2\"\n          class=\"mb-0 pb-0\"\n      >\n        <div v-if=\"helpKey === 'build_version'\">\n          <p>\n            Defines start version of your\n            <a target=\"_black\" href=\"https://en.wikipedia.org/wiki/Software_build\">artifact</a>.\n            Each run increments the artifact version.\n          </p>\n          <p>\n            For more information about building, see the\n            <a href=\"https://docs.ansible-semaphore.com/user-guide/task-templates#build\"\n               target=\"_blank\"\n            >Task Template reference</a>.\n          </p>\n        </div>\n        <div v-else-if=\"helpKey === 'build'\">\n          <p>\n            Defines what\n            <a target=\"_black\" href=\"https://en.wikipedia.org/wiki/Software_build\">artifact</a>\n            should be deployed when the task run.\n          </p>\n          <p>\n            For more information about deploying, see the\n            <a href=\"https://docs.ansible-semaphore.com/user-guide/task-templates#build\"\n               target=\"_blank\"\n            >Task Template reference</a>.\n          </p>\n        </div>\n        <div v-if=\"helpKey === 'cron'\">\n          <p>Defines autorun schedule.</p>\n          <p>\n            For more information about cron, see the\n            <a href=\"https://pkg.go.dev/github.com/robfig/cron#hdr-CRON_Expression_Format\"\n               target=\"_blank\"\n            >Cron expression format reference</a>.\n          </p>\n        </div>\n      </v-alert>\n    </v-dialog>\n\n    <v-alert\n        :value=\"formError\"\n        color=\"error\"\n        class=\"pb-2\"\n    >{{ formError }}\n    </v-alert>\n\n    <v-row>\n      <v-col cols=\"12\" md=\"6\" class=\"pb-0\">\n        <v-card class=\"mb-6\">\n          <v-tabs\n              fixed-tabs\n              v-model=\"itemTypeIndex\"\n          >\n            <v-tab\n                style=\"padding: 0\"\n                v-for=\"(key) in Object.keys(TEMPLATE_TYPE_ICONS)\"\n                :key=\"key\"\n            >\n              <v-icon small class=\"mr-2\">{{ TEMPLATE_TYPE_ICONS[key] }}</v-icon>\n              {{ TEMPLATE_TYPE_TITLES[key] }}\n            </v-tab>\n          </v-tabs>\n\n          <div class=\"ml-4 mr-4 mt-6\" v-if=\"item.type\">\n            <v-text-field\n                v-if=\"item.type === 'build'\"\n                v-model=\"item.start_version\"\n                label=\"Start Version\"\n                :rules=\"[v => !!v || 'Start Version is required']\"\n                required\n                :disabled=\"formSaving\"\n                placeholder=\"Example: 0.0.0\"\n                append-outer-icon=\"mdi-help-circle\"\n                @click:append-outer=\"showHelpDialog('build_version')\"\n            ></v-text-field>\n\n            <v-select\n                v-if=\"item.type === 'deploy'\"\n                v-model=\"item.build_template_id\"\n                label=\"Build Template\"\n                :items=\"buildTemplates\"\n                item-value=\"id\"\n                item-text=\"alias\"\n                :rules=\"[v => !!v || 'Build Template is required']\"\n                required\n                :disabled=\"formSaving\"\n                append-outer-icon=\"mdi-help-circle\"\n                @click:append-outer=\"showHelpDialog('build')\"\n            ></v-select>\n\n          </div>\n\n        </v-card>\n\n        <v-text-field\n            v-model=\"item.alias\"\n            label=\"剧本别名\"\n            :rules=\"[v => !!v || 'Playbook Alias is required']\"\n            required\n            :disabled=\"formSaving\"\n        ></v-text-field>\n\n        <v-text-field\n            v-model=\"item.playbook\"\n            label=\"剧本文件\"\n            :rules=\"[v => !!v || 'Playbook Filename is required']\"\n            required\n            :disabled=\"formSaving\"\n            placeholder=\"Example: site.yml\"\n        ></v-text-field>\n\n        <v-select\n            v-model=\"item.inventory_id\"\n            label=\"主机清单\"\n            :items=\"inventory\"\n            item-value=\"id\"\n            item-text=\"name\"\n            :rules=\"[v => !!v || 'Inventory is required']\"\n            required\n            :disabled=\"formSaving\"\n        ></v-select>\n\n        <v-select\n            v-model=\"item.repository_id\"\n            label=\"剧本仓库\"\n            :items=\"repositories\"\n            item-value=\"id\"\n            item-text=\"name\"\n            :rules=\"[v => !!v || 'Playbook Repository is required']\"\n            required\n            :disabled=\"formSaving\"\n        ></v-select>\n\n        <v-select\n            v-model=\"item.environment_id\"\n            label=\"运行环境\"\n            :items=\"environment\"\n            item-value=\"id\"\n            item-text=\"name\"\n            :rules=\"[v => !!v || 'Environment is required']\"\n            required\n            :disabled=\"formSaving\"\n        ></v-select>\n        <v-select\n            v-model=\"item.vault_key_id\"\n            label=\"库密码\"\n            clearable\n            :items=\"loginPasswordKeys\"\n            item-value=\"id\"\n            item-text=\"name\"\n            :disabled=\"formSaving\"\n        ></v-select>\n      </v-col>\n\n      <v-col cols=\"12\" md=\"6\" class=\"pb-0\">\n        <v-textarea\n            outlined\n            v-model=\"item.description\"\n            label=\"描述\"\n            :disabled=\"formSaving\"\n            rows=\"5\"\n        ></v-textarea>\n\n        <codemirror\n            :style=\"{ border: '1px solid lightgray' }\"\n            v-model=\"item.arguments\"\n            :options=\"cmOptions\"\n            :disabled=\"formSaving\"\n            placeholder='Enter extra CLI Arguments...\nExample:\n[\n  \"-i\",\n  \"@myinventory.sh\",\n  \"--private-key=/there/id_rsa\",\n  \"-vvvv\"\n]'\n        />\n\n        <v-select\n            v-model=\"item.view_id\"\n            label=\"所属视图\"\n            clearable\n            :items=\"views\"\n            item-value=\"id\"\n            item-text=\"title\"\n            :disabled=\"formSaving\"\n        ></v-select>\n\n        <v-text-field\n            class=\"mt-6\"\n            v-model=\"cronFormat\"\n            label=\"定时执行\"\n            :disabled=\"formSaving\"\n            placeholder=\"Example: 0 */5 * * *\"\n            v-if=\"schedules == null || schedules.length <= 1\"\n            append-outer-icon=\"mdi-help-circle\"\n            @click:append-outer=\"showHelpDialog('cron')\"\n        ></v-text-field>\n      </v-col>\n    </v-row>\n  </v-form>\n</template>\n<script>\n/* eslint-disable import/no-extraneous-dependencies,import/extensions */\n\nimport ItemFormBase from '@/components/ItemFormBase';\nimport axios from 'axios';\n\nimport { codemirror } from 'vue-codemirror';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/mode/vue/vue.js';\n// import 'codemirror/addon/lint/json-lint.js';\nimport 'codemirror/addon/display/placeholder.js';\nimport { TEMPLATE_TYPE_ICONS, TEMPLATE_TYPE_TITLES } from '../lib/constants';\n\nexport default {\n  mixins: [ItemFormBase],\n\n  components: {\n    codemirror,\n  },\n\n  props: {\n    sourceItemId: String,\n  },\n\n  data() {\n    return {\n      itemTypeIndex: 0,\n      TEMPLATE_TYPE_ICONS,\n      TEMPLATE_TYPE_TITLES,\n      cmOptions: {\n        tabSize: 2,\n        mode: 'application/json',\n        lineNumbers: true,\n        line: true,\n        lint: true,\n        indentWithTabs: false,\n      },\n      item: null,\n      keys: null,\n      inventory: null,\n      repositories: null,\n      environment: null,\n      schedules: null,\n      views: null,\n      cronFormat: null,\n      helpDialog: null,\n      helpKey: null,\n    };\n  },\n\n  watch: {\n    needReset(val) {\n      if (val) {\n        if (this.item != null) {\n          this.item.template_id = this.templateId;\n        }\n      }\n    },\n\n    sourceItemId(val) {\n      this.item.template_id = val;\n    },\n\n    itemTypeIndex(val) {\n      this.item.type = Object.keys(TEMPLATE_TYPE_ICONS)[val];\n    },\n  },\n\n  computed: {\n    isLoaded() {\n      if (this.isNew && this.sourceItemId == null) {\n        return true;\n      }\n\n      return this.keys != null\n          && this.repositories != null\n          && this.inventory != null\n          && this.environment != null\n          && this.item != null\n          && this.schedules != null\n          && this.views != null;\n    },\n\n    loginPasswordKeys() {\n      if (this.keys == null) {\n        return null;\n      }\n      return this.keys.filter((key) => key.type === 'login_password');\n    },\n  },\n\n  methods: {\n    showHelpDialog(key) {\n      this.helpKey = key;\n      this.helpDialog = true;\n    },\n\n    async afterLoadData() {\n      if (this.sourceItemId) {\n        this.item = (await axios({\n          keys: 'get',\n          url: `/api/project/${this.projectId}/templates/${this.sourceItemId}`,\n          responseType: 'json',\n        })).data;\n      }\n\n      this.keys = (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/keys`,\n        responseType: 'json',\n      })).data;\n\n      this.repositories = (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/repositories`,\n        responseType: 'json',\n      })).data;\n\n      this.inventory = (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/inventory`,\n        responseType: 'json',\n      })).data;\n\n      this.environment = (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/environment`,\n        responseType: 'json',\n      })).data;\n\n      this.buildTemplates = (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/templates?type=build`,\n        responseType: 'json',\n      })).data.filter((template) => template.type === 'build');\n\n      this.schedules = this.isNew ? [] : (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/templates/${this.itemId}/schedules`,\n        responseType: 'json',\n      })).data;\n\n      this.views = (await axios({\n        keys: 'get',\n        url: `/api/project/${this.projectId}/views`,\n        responseType: 'json',\n      })).data;\n\n      if (this.schedules.length === 1) {\n        this.cronFormat = this.schedules[0].cron_format;\n      }\n\n      this.itemTypeIndex = Object.keys(TEMPLATE_TYPE_ICONS).indexOf(this.item.type);\n    },\n\n    getItemsUrl() {\n      return `/api/project/${this.projectId}/templates`;\n    },\n\n    getSingleItemUrl() {\n      return `/api/project/${this.projectId}/templates/${this.itemId}`;\n    },\n\n    async beforeSave() {\n      if (this.cronFormat == null || this.cronFormat === '') {\n        return;\n      }\n\n      await axios({\n        method: 'post',\n        url: `/api/project/${this.projectId}/schedules/validate`,\n        responseType: 'json',\n        data: {\n          cron_format: this.cronFormat,\n        },\n      });\n    },\n\n    async afterSave(newItem) {\n      if (newItem || this.schedules.length === 0) {\n        if (this.cronFormat != null && this.cronFormat !== '') {\n          // new schedule\n          await axios({\n            method: 'post',\n            url: `/api/project/${this.projectId}/schedules`,\n            responseType: 'json',\n            data: {\n              project_id: this.projectId,\n              template_id: newItem ? newItem.id : this.itemId,\n              cron_format: this.cronFormat,\n            },\n          });\n        }\n      } else if (this.schedules.length > 1) {\n        // do nothing\n      } else if (this.cronFormat == null || this.cronFormat === '') {\n        // drop schedule\n        await axios({\n          method: 'delete',\n          url: `/api/project/${this.projectId}/schedules/${this.schedules[0].id}`,\n          responseType: 'json',\n        });\n      } else {\n        // update schedule\n        await axios({\n          method: 'put',\n          url: `/api/project/${this.projectId}/schedules/${this.schedules[0].id}`,\n          responseType: 'json',\n          data: {\n            id: this.schedules[0].id,\n            project_id: this.projectId,\n            template_id: this.itemId,\n            cron_format: this.cronFormat,\n          },\n        });\n      }\n    },\n  },\n};\n</script>\n"]}]}