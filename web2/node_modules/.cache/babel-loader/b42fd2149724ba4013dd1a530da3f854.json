{"remainingRequest":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/thread-loader/dist/cjs.js!/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/babel-loader/lib/index.js!/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/src/views/project/History.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/src/views/project/History.vue","mtime":1638857107767},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lx/go/src/github.com/ansible-semaphore/semaphore/web2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvbHgvZ28vc3JjL2dpdGh1Yi5jb20vYW5zaWJsZS1zZW1hcGhvcmUvc2VtYXBob3JlL3dlYjIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvbHgvZ28vc3JjL2dpdGh1Yi5jb20vYW5zaWJsZS1zZW1hcGhvcmUvc2VtYXBob3JlL3dlYjIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgSXRlbUxpc3RQYWdlQmFzZSBmcm9tICdAL2NvbXBvbmVudHMvSXRlbUxpc3RQYWdlQmFzZSc7CmltcG9ydCBFdmVudEJ1cyBmcm9tICdAL2V2ZW50LWJ1cyc7CmltcG9ydCBUYXNrU3RhdHVzIGZyb20gJ0AvY29tcG9uZW50cy9UYXNrU3RhdHVzLnZ1ZSc7CmltcG9ydCBUYXNrTGluayBmcm9tICdAL2NvbXBvbmVudHMvVGFza0xpbmsudnVlJzsKaW1wb3J0IHNvY2tldCBmcm9tICdAL3NvY2tldCc7CmltcG9ydCB7IFRFTVBMQVRFX1RZUEVfSUNPTlMgfSBmcm9tICdAL2xpYi9jb25zdGFudHMnOwpleHBvcnQgZGVmYXVsdCB7CiAgbWl4aW5zOiBbSXRlbUxpc3RQYWdlQmFzZV0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIFRFTVBMQVRFX1RZUEVfSUNPTlM6IFRFTVBMQVRFX1RZUEVfSUNPTlMKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBUYXNrU3RhdHVzOiBUYXNrU3RhdHVzLAogICAgVGFza0xpbms6IFRhc2tMaW5rCiAgfSwKICB3YXRjaDogewogICAgcHJvamVjdElkOiBmdW5jdGlvbiBwcm9qZWN0SWQoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvYWRJdGVtcygpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgc29ja2V0LmFkZExpc3RlbmVyKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpczIub25XZWJzb2NrZXREYXRhUmVjZWl2ZWQoZGF0YSk7CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNob3dUYXNrTG9nOiBmdW5jdGlvbiBzaG93VGFza0xvZyh0YXNrSWQpIHsKICAgICAgRXZlbnRCdXMuJGVtaXQoJ2ktc2hvdy10YXNrJywgewogICAgICAgIHRhc2tJZDogdGFza0lkCiAgICAgIH0pOwogICAgfSwKICAgIG9uV2Vic29ja2V0RGF0YVJlY2VpdmVkOiBmdW5jdGlvbiBvbldlYnNvY2tldERhdGFSZWNlaXZlZChkYXRhKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHRhc2s7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghKGRhdGEucHJvamVjdF9pZCAhPT0gX3RoaXMzLnByb2plY3RJZCB8fCBkYXRhLnR5cGUgIT09ICd1cGRhdGUnKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMy5pdGVtcy5zb21lKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkID09PSBkYXRhLnRhc2tfaWQ7CiAgICAgICAgICAgICAgICB9KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMubG9hZEl0ZW1zKCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHRhc2sgPSBfdGhpczMuaXRlbXMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5pZCA9PT0gZGF0YS50YXNrX2lkOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRhc2ssIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZGF0YSksIHt9LCB7CiAgICAgICAgICAgICAgICAgIHR5cGU6IHVuZGVmaW5lZAogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBnZXRIZWFkZXJzOiBmdW5jdGlvbiBnZXRIZWFkZXJzKCkgewogICAgICByZXR1cm4gW3sKICAgICAgICB0ZXh0OiAn5Lu75YqhJywKICAgICAgICB2YWx1ZTogJ3RwbF9hbGlhcycsCiAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAn54mI5pysJywKICAgICAgICB2YWx1ZTogJ3ZlcnNpb24nLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZQogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ+eKtuaAgScsCiAgICAgICAgdmFsdWU6ICdzdGF0dXMnLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZQogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ+eUqOaItycsCiAgICAgICAgdmFsdWU6ICd1c2VyX25hbWUnLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZQogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ+WQr+WKqCcsCiAgICAgICAgdmFsdWU6ICdzdGFydCcsCiAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAn5oyB57ut5pe26Ze0JywKICAgICAgICB2YWx1ZTogJ2VuZCcsCiAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgIH1dOwogICAgfSwKICAgIGdldEl0ZW1zVXJsOiBmdW5jdGlvbiBnZXRJdGVtc1VybCgpIHsKICAgICAgcmV0dXJuICIvYXBpL3Byb2plY3QvIi5jb25jYXQodGhpcy5wcm9qZWN0SWQsICIvdGFza3MvbGFzdCIpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["History.vue"],"names":[],"mappings":"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","sourcesContent":["<template xmlns:v-slot=\"http://www.w3.org/1999/XSL/Transform\">\n  <div v-if=\"items != null\">\n    <v-toolbar flat color=\"white\">\n      <v-app-bar-nav-icon @click=\"showDrawer()\"></v-app-bar-nav-icon>\n      <v-toolbar-title>仪表盘</v-toolbar-title>\n      <v-spacer></v-spacer>\n      <div>\n        <v-tabs centered>\n          <v-tab key=\"history\" :to=\"`/project/${projectId}/history`\">历史</v-tab>\n          <v-tab key=\"activity\" :to=\"`/project/${projectId}/activity`\">动作</v-tab>\n          <v-tab key=\"settings\" :to=\"`/project/${projectId}/settings`\">设置</v-tab>\n        </v-tabs>\n      </div>\n    </v-toolbar>\n    <v-data-table\n        :headers=\"headers\"\n        :items=\"items\"\n        :footer-props=\"{ itemsPerPageOptions: [20] }\"\n        class=\"mt-4\"\n    >\n      <template v-slot:item.tpl_alias=\"{ item }\">\n        <div class=\"d-flex\">\n          <v-icon class=\"mr-3\" small>\n            {{ TEMPLATE_TYPE_ICONS[item.tpl_type] }}\n          </v-icon>\n\n          <TaskLink\n              :task-id=\"item.id\"\n              :tooltip=\"item.message\"\n              :label=\"'#' + item.id\"\n          />\n\n          <v-icon small class=\"ml-1 mr-1\">mdi-arrow-left</v-icon>\n\n          <a :href=\"\n          '/project/' + item.project_id +\n          '/templates/' + item.template_id\"\n          >{{ item.tpl_alias }}</a>\n        </div>\n      </template>\n      <template v-slot:item.version=\"{ item }\">\n        <TaskLink\n            :disabled=\"item.tpl_type === 'build'\"\n            class=\"ml-2\"\n            v-if=\"item.tpl_type !== ''\"\n            :status=\"item.status\"\n\n            :task-id=\"item.tpl_type === 'build'\n              ? item.id\n              : item.build_task.id\"\n\n            :label=\"item.tpl_type === 'build'\n              ? item.version\n              : item.build_task.version\"\n\n            :tooltip=\"item.tpl_type === 'build'\n              ? item.message\n              : item.build_task.message\"\n        />\n        <div class=\"text-center\" v-else>&mdash;</div>\n      </template>\n\n      <template v-slot:item.status=\"{ item }\">\n        <TaskStatus :status=\"item.status\"/>\n      </template>\n\n      <template v-slot:item.start=\"{ item }\">\n        {{ item.start | formatDate }}\n      </template>\n\n      <template v-slot:item.end=\"{ item }\">\n        {{ [item.start, item.end] | formatMilliseconds }}\n      </template>\n    </v-data-table>\n  </div>\n</template>\n\n<script>\nimport ItemListPageBase from '@/components/ItemListPageBase';\nimport EventBus from '@/event-bus';\nimport TaskStatus from '@/components/TaskStatus.vue';\nimport TaskLink from '@/components/TaskLink.vue';\nimport socket from '@/socket';\nimport { TEMPLATE_TYPE_ICONS } from '@/lib/constants';\n\nexport default {\n  mixins: [ItemListPageBase],\n\n  data() {\n    return { TEMPLATE_TYPE_ICONS };\n  },\n\n  components: { TaskStatus, TaskLink },\n\n  watch: {\n    async projectId() {\n      await this.loadItems();\n    },\n  },\n\n  created() {\n    socket.addListener((data) => this.onWebsocketDataReceived(data));\n  },\n\n  methods: {\n    showTaskLog(taskId) {\n      EventBus.$emit('i-show-task', {\n        taskId,\n      });\n    },\n\n    async onWebsocketDataReceived(data) {\n      if (data.project_id !== this.projectId || data.type !== 'update') {\n        return;\n      }\n\n      if (!this.items.some((item) => item.id === data.task_id)) {\n        await this.loadItems();\n      }\n\n      const task = this.items.find((item) => item.id === data.task_id);\n\n      Object.assign(task, {\n        ...data,\n        type: undefined,\n      });\n    },\n\n    getHeaders() {\n      return [\n        {\n          text: '任务',\n          value: 'tpl_alias',\n          sortable: false,\n        },\n        {\n          text: '版本',\n          value: 'version',\n          sortable: false,\n        },\n        {\n          text: '状态',\n          value: 'status',\n          sortable: false,\n        },\n        {\n          text: '用户',\n          value: 'user_name',\n          sortable: false,\n        },\n        {\n          text: '启动',\n          value: 'start',\n          sortable: false,\n        },\n        {\n          text: '持续时间',\n          value: 'end',\n          sortable: false,\n        },\n      ];\n    },\n\n    getItemsUrl() {\n      return `/api/project/${this.projectId}/tasks/last`;\n    },\n  },\n};\n</script>\n"],"sourceRoot":"src/views/project"}]}